#:import Factory kivy.factory.Factory

<MainScreen>: 
    main_temp:main_temp
    dhtview:dhtview
    tempgraph:tempgraph
    releview:releview
    FloatLayout:
        canvas.before:
            Color:
                rgba:1,1,1,1
            Rectangle:
                pos: self.pos
                size: self.size
                source:'web/images/sfondo.png'
        
           
        Button:
            size_hint:None,None
            size:50,50
            pos_hint:{"center_x":.90,"top":.98}
            allow_stretch: True
            keep_ratio: False
            background_normal: 'web/images/sistema.png'
            background_down:'web/mages/sistema1_1.png'
            on_press:root.anti_minimize()
            on_release:Factory.SystemPopup().open() 
        
        Label:
            text:"[b]19.1°[/b]"
            color:0,0,0.1,1
            font_size:'110dp'
            outline_width:2
            outline_color:0.8,0.9,0,1
            title_align: 'center'
            halign:'center'
            id:main_temp
            size_hint:0.4,0.4
            pos_hint:{"center_x":.51,"top":.93}
            markup: True
            shorten: True
            ellipsis_options: {'color':(1,0.5,0.5,1),'underline':True}
        Label:
            text:root.main_umidita
            color: 0.8,0,1,1
            font_size:'20dp'
            size_hint:0.4,0.4
            pos_hint:{"center_x":.5,"top":.78}
            markup: True
            shorten: True
            halign:'center'
            ellipsis_options: {'color':(1,0.5,0.5,1),'underline':True}
        Label:
            text:root.main_time
            color:0.956, 0.564, 0.082,1
            outline_width:2
            outline_color:0.019, 0.117, 0.580,1
            font_size:'45dp'
            size_hint:[None,None]
            pos_hint:{"center_x":.5,"top":1.05}
            halign:'center'
            markup: True
            shorten: True
            ellipsis_options: {'color':(1,0.5,0.5,1),'underline':True}
        Label:
            text:root.main_date
            color:0.925, 0.686, 0.035,1
            outline_width:2
            outline_color:0.019, 0.117, 0.580,1
            font_size:'30dp'
            size_hint:[None,None]
            pos_hint:{"center_x":.15,"top":1.05}
            halign:'left'
            markup: True
            shorten: True
            ellipsis_options: {'color':(1,0.5,0.5,1),'underline':True}
        Button:
            size_hint:None,None
            size:200,150
            pos_hint:{"center_x":.14,"top":.92}
            allow_stretch: True
            keep_ratio: False
            background_normal: 'web/images/meteo.png'
            background_down: 'web/images/down.png'
            on_press:app.root.current = 'meteo'
        Image:
            size_hint:None,None
            size:52,52
            pos_hint:{"center_x":.14,"top":.90}
            source:root.main_meteo
            allow_stretch: True
            keep_ratio: False
        Image:
            size_hint:None,None
            size:30,120
            pos_hint:{"center_x":.69,"top":.82}
            source:root.main_tendenza
            allow_stretch: True
            keep_ratio: False
        Label:
            text:root.main_meteo_text
            color: 1,0.8,.8,1
            font_size:'20dp'
            size_hint:[None,None]
            pos_hint:{"center_x":.14,"top":.80}
            halign:'center'
            markup: True
            shorten: True
            ellipsis_options: {'color':(1,0.5,0.5,1),'underline':True}

        Label:
            text:root.main_explain
            color:0.925, 0.686, 0.035,1
            outline_width:2
            outline_color:0.019, 0.117, 0.580,1
            font_size:'23dp'
            pos_hint:{"center_x":.87,"top":.9}
            size: self.texture_size 
            size_hint: None, None 
            size:(50,100)
            markup: True
            halign:'center'
            valign:'bottom' 
        Label:
            text:root.main_next
            color: 1,0.8,0.8,1
            pos_hint:{"center_x":.87,"top":.64}
            size: self.texture_size 
            size_hint: None, None 
            size:(100,20)
            markup: True
            halign:'center'
            valign:'bottom' 
        Label:
            canvas.before:
                Color:
                    rgba:1,1,1,0
                Rectangle:
                    pos: self.pos
                    size: self.size
            text:root.main_setTemp + "°" if root.main_state <= 5 else root.main_setTemp
            color: (1,0.1,0.1,1) if root.slider_color == 1 else (0.1,1,0.1,1)
            outline_width:2
            outline_color:(0.8,0.9,0,1) if root.slider_color == 1 else (.2,.2,1,1)
            halign:'center'
            size_hint:0.4,0.4
            pos_hint:{"center_x":.88,"top":.90}
            size: self.texture_size 
            font_size:'60dp'
            markup: True
            valign:'bottom' 
        Button:
            size_hint:None,None
            size:180,100
            title_align: 'center'
            pos_hint:{"center_x":.87,"top":.80}
            allow_stretch: True
            keep_ratio: False
            background_normal: 'web/images/meteo.png'
            background_down: 'web/images/down.png'
            on_press:root.anti_minimize()
            on_release:Factory.MyPopup().open() 
        
        
        Dhtview:
            id:dhtview
        Releview:
            id:releview
        Tempgraph:
            id:tempgraph
        
<MyPopup@Popup>:
    auto_dismiss: False
    size_hint:0.8,0.8
    pos_hint:{"center_x":.5,"top":.9}
    title: "Setting"
    title_align: 'center'
    title_size:'30dp'
    background:"web/images/boot.png"
    FloatLayout:
        Button:
            size_hint:None,None
            size:64,64
            pos_hint:{"center_x":.05,"top":.85}
            allow_stretch: True
            keep_ratio: False
            background_normal: 'web/images/menomeno.png'
            on_press: app.root.main_screen.popup(-1)
        Button:
            size_hint:None,None
            size:64,64
            pos_hint:{"center_x":.20,"top":.85}
            allow_stretch: 
            keep_ratio: False
            background_normal: 'web/images/meno.png'
            on_press: app.root.main_screen.popup(-0.1)
        Button:
            size_hint:None,None
            size:64,64
            pos_hint:{"center_x":.80,"top":.85}
            allow_stretch: True
            keep_ratio: False
            background_normal: 'web/images/piu.png'
            on_press: app.root.main_screen.popup(0.1)
        Button:
            size_hint:None,None
            size:64,64
            pos_hint:{"center_x":.95,"top":.85}
            allow_stretch: True
            keep_ratio: False
            background_normal: 'web/images/piupiu.png'
            on_press: app.root.main_screen.popup(1)
        Label:
            text:app.root.main_screen.main_set_setTemp
            id:set
            color:0,0,0.1,1
            font_size:'90dp'
            outline_width:2
            outline_color:0.8,0.9,0,1
            halign:'center'
            size_hint:0.4,0.4
            pos_hint:{"center_x":.51,"top":.95}
            markup: True
            shorten: True
            ellipsis_options: {'color':(1,0.5,0.5,1),'underline':True}
        ToggleButton:
            text: 'Auto'
            group:'setstate'
            state:'down' if app.root.main_screen.main_state == 1 else 'normal'
            size_hint:None,None
            font_size:'30dp'
            background_normal: 'web/images/normal.png'
            background_down: 'web/images/down.png'
            size:125,67
            pos_hint:{"center_x":.2,"top":.55}
            allow_stretch: True
            keep_ratio: False
            on_press:app.root.main_screen.switch(1)
            
        ToggleButton:
            text: 'Manuale'
            group:'setstate'
            background_normal: 'web/images/normal.png'
            background_down: 'web/images/down.png'
            state:'down' if app.root.main_screen.main_state == 2 else 'normal'
            size_hint:None,None
            font_size:'30dp'
            size:125,67
            pos_hint:{"center_x":.5,"top":.55}
            allow_stretch: True
            keep_ratio: False
            on_press:app.root.main_screen.switch(2)
            
        ToggleButton:
            text: 'NoIce'
            group:'setstate'
            background_normal: 'web/images/normal.png'
            background_down: 'web/images/down.png'
            state:'down' if app.root.main_screen.main_state == 3 else 'normal'
            size_hint:None,None
            font_size:'30dp'
            size:125,67
            pos_hint:{"center_x":.8,"top":.55}
            allow_stretch: True
            keep_ratio: False
            on_press:app.root.main_screen.switch(3)
            
        Button:
            text: 'Set'
            background_normal: 'web/images/set.png'
            background_down: 'web/images/down.png'
            size_hint:None,None
            font_size:'30dp'
            size:200,67
            pos_hint:{"center_x":.5,"top":.25}
            allow_stretch: True
            keep_ratio: False
            on_press:app.root.main_screen.update_temp(set.text)
            on_release: root.dismiss()
            
<SystemPopup@Popup>:
    auto_dismiss: False
    size_hint:0.8,0.8
    pos_hint:{"center_x":.5,"top":.9}
    title: "Menu"
    title_align: 'center'
    title_size:'30dp'
    background:"web/images/boot.png"
    FloatLayout:
        Button:
            text: 'Estate'
            background_normal: 'web/images/set.png'
            background_down: 'web/images/down.png'
            allow_stretch: True
            keep_ratio: False
            size_hint:None,None
            font_size:'30dp'
            size:125,67
            pos_hint:{"center_x":.5,"top":.7}
            on_press:app.root.main_screen.press_estate()
            on_release: root.dismiss()
        Button:
            text: 'Spegni'
            background_normal: 'web/images/set.png'
            background_down: 'web/images/down.png'
            allow_stretch: True
            keep_ratio: False
            size_hint:None,None
            font_size:'30dp'
            size:125,67
            pos_hint:{"center_x":.2,"top":.7}
            on_press: app.root.main_screen.update_schema(7)
            on_release: root.dismiss()
        Button:
            text: 'Uscita'
            background_normal: 'web/images/set.png'
            background_down: 'web/images/down.png'
            allow_stretch: True
            keep_ratio: False
            size_hint:None,None
            font_size:'30dp'
            size:125,67
            pos_hint:{"center_x":.8,"top":.7}
            on_press: app.root.main_screen.update_schema(8)
            on_release: root.dismiss() 
        Button:
            text: 'Annulla'
            background_normal: 'web/images/set.png'
            background_down: 'web/images/down.png'
            allow_stretch: True
            keep_ratio: False
            size_hint:None,None
            font_size:'30dp'
            size:200,67
            pos_hint:{"center_x":.5,"top":.3}
            on_press: root.dismiss()    
